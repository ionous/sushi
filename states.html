<!-- ngView creates the ga-map view dynamically -->
<hsm-state name="ViewPending">
  <hsm-event on="ga-map-created" goto="ViewReady"></hsm-event>
</hsm-state>
<hsm-state name="ViewReady" ga-resources="play" hsm-enter="play.load($evt.mapSlot,$evt.mapData)" hsm-exit="play.unload()">
  <hsm-event on="ga-map-destroyed" goto="ViewPending"></hsm-event>
  <!--  -->
  <hsm-state name="ResourcesPending">
    <hsm-event on="ga-resources-loaded" goto="Commanding"></hsm-event>
  </hsm-state>
  <!--  -->
  <hsm-state avatar-control="avatar" avatar-size="12" hsm-enter="avatar.create(play.get('player'), play.get('physics'), play.get('pads'))" hsm-exit="avatar.destroy()">
    <hsm-state>
      <hsm-event on="demo-console" goto="Console"></hsm-event>
      <hsm-event on="demo-inventory" goto="Inventory"></hsm-event>
      <hsm-event on="demo-settings" goto="Settings"></hsm-event>
      <!--  -->
      <hsm-state name="WindowOpened">
        <hsm-event on="ga-window-closed" goto="Commanding"></hsm-event>
        <hsm-state name="Console" console-control="console" hsm-enter="console.show()" hsm-exit="console.hide()">
          <hsm-state name="Inner" ga-timeout="wait" hsm-enter="wait.timeout(300, 'wait-timeout')" hsm-exit="wait.cancel()">
          </hsm-state>
        </hsm-state>
        <hsm-state name="Inventory" inventory-control="inv" hsm-enter="inv.show()" hsm-exit="inv.hide()">
        </hsm-state>
        <hsm-state name="Settings" settings-control="settings" hsm-enter="settings.show()" hsm-exit="settings.hide()">
        </hsm-state>
      </hsm-state>
      <!--  -->
      <hsm-state name="Commanding" mouse-control="mouse" hsm-enter="mouse.createAt(play.get('mapSlot'))" hsm-exit="mouse.destroy()">
        <hsm-state parallel="true" mouse-target="mouseTarget" hsm-enter="mouseTarget.bind(mouse,play.get('hitGroups'))" hsm-exit="mouseTarget.release()">
          <ng-include src="'hover.html'"></ng-include>
          <ng-include src="'interact.html'"></ng-include>
        </hsm-state>
      </hsm-state>
    </hsm-state>
  </hsm-state>
</hsm-state>
