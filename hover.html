<!-- mouse input tweaks the cursor, and raises events which effect player control. -->
<hsm-state name="Hover" hover-control="hover" hsm-init="mouse.inBounds() ? 'InBounds' : 'OutOfBounds'">
  <hsm-state name="OutOfBounds" mouse-hide-control="mbounds" hsm-enter="mbounds.hide()" hsm-exit="mbounds.show()">
    <hsm-event on="mouse-enter" goto="InBounds"></hsm-event>
    <!-- <hsm-event on="mouse-move" goto="InBounds"></hsm-event> -->
  </hsm-state>
  <hsm-state name="InBounds" hsm-init="mouse.hidden() && 'MouseHidden'">
    <hsm-event on="mouse-leave" goto="OutOfBounds"> </hsm-event>
    <!-- now wait for mouse down -->
    <hsm-state name="MouseHighlight">
      <hsm-event on="mouse-down" goto="MouseDown" run="hover.press(mouse.pos())"></hsm-event>
    </hsm-state>
    <!-- mouse -->
    <hsm-state name="MouseDown" timeout-state="wait" hsm-enter="wait.timeout(150)">
      <!-- on mouse up within time - ie. something like a click.   -->
      <hsm-event on="mouse-up" run="hover.select(mouse.pos())" goto="MouseHighlight"></hsm-event>
      <!-- on timeout begin a directed move - ie. something like a drag. -->
      <!-- FIX? should this also happen if the mouse is moved past a tolerance? the time is pretty short, so maybe it doesnt matter. -->
      <hsm-event on="wait-timeout" run="hover.direct(mouse.pause())" goto="MouseDirecting"> </hsm-event>
    </hsm-state>
    <!-- FIX? raise a direct end? -->
    <hsm-state name="MouseDirecting">
      <hsm-event on="mouse-up" goto="MouseHighlight"></hsm-event>
    </hsm-state>
    <!--  -->
    <hsm-event on="mouse-hidden" goto="MouseHidden"></hsm-event>
    <hsm-state name="MouseHidden">
      <hsm-event on="mouse-shown" goto="MouseHighlight"></hsm-event>
    </hsm-state>
  </hsm-state>
</hsm-state>
