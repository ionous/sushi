<hsm-state name="Statics" action-bar-control="actionBar" hsm-enter="actionBar.bindTo('gameMap')" hsm-exit="actionBar.destroy()" hsm-init="stream.processing() ? 'StaticsPause' : (modal.showing() ? 'StaticsModal' : 'StaticsPlay')">
  <hsm-state name="StaticsPlay" mouse-target="mouseTarget" hsm-enter="mouseTarget.bind(map)" hsm-exit="mouseTarget.release()">
    <!--  -->
    <hsm-event on="update-game" run="mouseTarget.update(mouse.pos())"></hsm-event>
    <hsm-event on="mouse-target-changed" goto="StaticTargeting"></hsm-event>
    <!--  -->
    <hsm-event on="modal-opened" when="$evt.matches('actionBar')"  goto="StaticsActionBar"></hsm-event>
    <hsm-event on="modal-opened" goto="StaticsModal"></hsm-event>
    <!--  -->
    <hsm-state name="StaticTargeting" hsm-init="mouseTarget() ? 'StaticHasTarget' : 'StaticNoTarget'">
      <hsm-state name="StaticNoTarget" hsm-enter="mouse.show('pointer')">
      </hsm-state>
      <hsm-state name="StaticHasTarget" hsm-enter="mouse.show('bullseye')">
        <hsm-event on="hover-press" run="player.facePos($evt.pos)"></hsm-event>
        <hsm-event on="hover-select" run="actionBar.open(mouseTarget(), combiner.item())"></hsm-event>
        <hsm-event on="player-interact" run="actionBar.open(mouseTarget(), combiner.item())"></hsm-event>
      </hsm-state>
    </hsm-state>
    <!--   -->
    <hsm-state name="StaticsActionBar" hsm-enter="mouseTarget.ghost(actionBar.target())" hsm-exit="mouseTarget.ghost(false)">
      <hsm-state hsm-exit="actionBar.dismiss($evt)">
        <hsm-event on="modal-closed" goto="StaticTargeting"></hsm-event>
      </hsm-state>
    </hsm-state>
  </hsm-state>
  <hsm-state name="StaticsModal">
    <hsm-event on="modal-closed" goto="StaticsPlay"></hsm-event>
  </hsm-state>
  <!--  -->
  <hsm-event on="stream-processing" goto="StaticsPause"></hsm-event>
  <hsm-state name="StaticsPause">
    <hsm-event on="stream-empty" goto="StaticsPlay"></hsm-event>
  </hsm-state>
</hsm-state>
